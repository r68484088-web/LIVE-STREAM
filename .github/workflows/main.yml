name: Start Live Stream
        env:
          STREAM_URL: "rtmp://a.rtmp.youtube.com/live2/k4bv-wakv-50ad-uas6-8rtr"
          GH_TOKEN: ${{ secrets.GH_PAT }}
        run: |
          echo "Processing Video: Forward + Reverse + 0.7x Slow Motion..."
          
          # FFmpeg Command with Complex Filter
          ffmpeg -re \
            -stream_loop -1 -i video.mp4 \
            -stream_loop -1 -i audio.mp3 \
            -filter_complex \
            "[0:v]setpts=PTS/0.7[v_slow]; \
             [v_slow]split[v1][v2]; \
             [v2]reverse[v_rev]; \
             [v1][v_rev]concat=n=2:v=1:a=0[v_final]; \
             [1:a]atempo=0.7[a_slow]; \
             [a_slow]asplit[a1][a2]; \
             [a2]areverse[a_rev]; \
             [a1][a_rev]concat=n=2:v=0:a=1[a_final]" \
            -map "[v_final]" -map "[a_final]" \
            -c:v libx264 \
            -preset veryfast \
            -pix_fmt yuv420p \
            -g 50 \
            -b:v 2000k \
            -c:a aac \
            -b:a 128k \
            -t 05:50:00 \
            -f flv \
            "$STREAM_URL"

          echo "FFmpeg finished. Triggering next workflow..."
          
          curl -X POST \
            -H "Authorization: token $GH_TOKEN" \
            -H "Accept: application/vnd.github.v3+json" \
            https://api.github.com/repos/${{ github.repository }}/dispatches \
            -d '{"event_type": "restart_stream"}'
            
